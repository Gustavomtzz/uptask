!function(){document.querySelector("#agregar-tarea").addEventListener("click",(function(){n()}));let e=[],t=[];function a(a){inputValor=a.target.value,t="1"===inputValor||"0"===inputValor?e.filter(e=>e.estado===inputValor):[],c()}function n(t=!1,a={},n=null){const s=document.createElement("DIV");s.setAttribute("id","modal"),s.classList.add("modal"),s.innerHTML=`\n        <form class="formulario nueva-tarea">   \n        <legend>${t?"Editar una Tarea":"A침ade una nueva tarea"} </legend>\n        \n        <div class="campo">\n        \n        <label for="tarea">Tarea:</label>\n        <input type="text" name="tarea" id="tarea" placeholder="${a.tarea?"Edita la tarea":"A침adir tarea la proyecto actual"}" value="${a.tarea?a.tarea:""}"/>    \n        \n        </div>\n        \n        <div class="opciones">\n        \n        <button type="button" class="cerrar-modal" id="cerrarModal">Cancelar</button>\n        <input type="submit" class="submit-nueva-tarea" value="${a.tarea?"Guardar Cambios":"A침adir Tarea"}" />    \n        \n        </div>\n        \n        </form>       \n        `,document.querySelector("BODY").appendChild(s),s.addEventListener("click",u=>{if(u.preventDefault(),id=u.target.getAttribute("id"),"submit"==u.target.type){const u=s.querySelector("#tarea"),m=u.value.trim();if(""===u.value)return void o("El nombre es obligatorio");const f=new FormData;f.append("tarea",m),f.append("idProyecto",d()),t?async function(t,a,n,d,l){t.append("id",a.id);try{const o="/api/tarea/actualizar",s=await fetch(o,{method:"POST",body:t});if(!0===await s.json()){const t={id:a.id,tarea:n,estado:a.estado,idProyecto:a.idProyecto};e[d]=t,i("Actualizada"),r(l),c()}}catch(e){o(e)}}(f,a,m,n,s):l(f,m)}"cerrarModal"===id&&document.querySelector("#modal").remove()})}function r(e){setTimeout(()=>{e.remove()},1e3)}function o(e){Swal.fire({icon:"error",title:"Hubo un Error",text:""+e,confirmButtonText:"Ok",confirmButtonColor:"#0891B2"})}function i(e){Swal.fire({icon:"success",title:"Tarea "+e,text:`Tu Tarea fue ${e} correctamente`,confirmButtonText:"Ok",confirmButtonColor:"#0891B2"})}function c(){!function(){const e=document.querySelector("#contenedor-tareas"),t=document.querySelector(".listar-tareas");t&&e.removeChild(t)}(),function(){const t=e.filter(e=>"0"===e.estado),a=document.querySelector("#activo");0===t.length?a.disabled=!0:a.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),a=document.querySelector("#completadas");0===t.length?a.disabled=!0:a.disabled=!1}();let a=[];a=0!==t.length?t:e;const r=document.querySelector("#contenedor-tareas"),o=document.createElement("TABLE"),i=document.createElement("TBODY");if(o.classList.add("listar-tareas"),0===a.length){const e=document.createElement("DIV");return e.classList.add("tarea-mensaje"),e.innerHTML='<i class="fa-solid fa-circle-exclamation"> No hay tareas</i>',void r.appendChild(e)}o.innerHTML="\n        <thead>\n        <tr>\n        <th>Tarea</th>\n        <th>Estado</th>\n        <th>Acciones</th>\n        </tr></thead>",a.forEach(e=>{const{id:t,tarea:a,idProyecto:n,estado:r}=e,o=document.createElement("tr");let c="0"===r?"Activo":"Completado";o.dataset.tareaId=t,o.innerHTML=`\n            <td id="nombreTarea">${a}</td>\n            <td>${c}</td>\n            <td class="acciones-tarea">\n            <a href="/api/tarea/actualizar?id=${t}">\n            <i class="fa-regular fa-pen-to-square" style="color: #F59E0B;"></i>\n            </a>\n            <form action="/api/tarea/eliminar" method="POST">  \n            <button type="submit" class="boton-eliminar">\n            <i class="fa-solid fa-trash" style="color: #c71a34;"></i>\n            </button>\n            <input type="hidden" name="id" value="${t}"/>\n            </form>\n            </td>\n            </tr>\n `,i.appendChild(o)}),o.appendChild(i),r.appendChild(o),document.querySelectorAll("#nombreTarea").forEach(t=>{t.style="cursor:pointer",t.addEventListener("dblclick",t=>{nombre=t.target.textContent,e.forEach((e,t)=>{e.tarea==nombre&&n(!0,e,t)})})})}function d(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}async function l(t,a){try{const n="/api/tarea/crear",d=await fetch(n,{method:"POST",body:t}),l=await d.json();if(!0===l.resultado){const t={id:l.id.toString(),tarea:a,estado:"0",idProyecto:l.idProyecto};e=[...e,t],i("Creada"),r(modal),c()}else"error"===l.tipo&&o(l.mensaje)}catch(e){o(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",a)}),document.addEventListener("DOMContentLoaded",(function(){!async function(){const t="/api/tarea?id="+d();try{const a=await fetch(t),n=await a.json();e=n,c()}catch(e){o("P치gina no encontrada"),setTimeout(()=>{window.location.replace("/dashboard")},3e3)}}()}))}();